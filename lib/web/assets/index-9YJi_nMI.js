(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var G,k,Ee,T,ue,Ce,Se,xe,ie,ee,te,M={},je=[],Me=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Q=Array.isArray;function P(t,e){for(var n in e)t[n]=e[n];return t}function oe(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Ue(t,e,n){var o,s,i,c={};for(i in e)i=="key"?o=e[i]:i=="ref"?s=e[i]:c[i]=e[i];if(arguments.length>2&&(c.children=arguments.length>3?G.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(i in t.defaultProps)c[i]===void 0&&(c[i]=t.defaultProps[i]);return V(t,c,o,s,null)}function V(t,e,n,o,s){var i={type:t,props:e,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++Ee,__i:-1,__u:0};return s==null&&k.vnode!=null&&k.vnode(i),i}function O(t){return t.children}function R(t,e){this.props=t,this.context=e}function D(t,e){if(e==null)return t.__?D(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?D(t):null}function Pe(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Pe(t)}}function de(t){(!t.__d&&(t.__d=!0)&&T.push(t)&&!z.__r++||ue!=k.debounceRendering)&&((ue=k.debounceRendering)||Ce)(z)}function z(){for(var t,e,n,o,s,i,c,u=1;T.length;)T.length>u&&T.sort(Se),t=T.shift(),u=T.length,t.__d&&(n=void 0,o=void 0,s=(o=(e=t).__v).__e,i=[],c=[],e.__P&&((n=P({},o)).__v=o.__v+1,k.vnode&&k.vnode(n),ae(e.__P,n,o,e.__n,e.__P.namespaceURI,32&o.__u?[s]:null,i,s??D(o),!!(32&o.__u),c),n.__v=o.__v,n.__.__k[n.__i]=n,Te(i,n,c),o.__e=o.__=null,n.__e!=s&&Pe(n)));z.__r=0}function $e(t,e,n,o,s,i,c,u,f,l,p){var a,_,d,y,g,m,v,w=o&&o.__k||je,N=e.length;for(f=Oe(n,e,w,f,N),a=0;a<N;a++)(d=n.__k[a])!=null&&(_=d.__i==-1?M:w[d.__i]||M,d.__i=a,m=ae(t,d,_,s,i,c,u,f,l,p),y=d.__e,d.ref&&_.ref!=d.ref&&(_.ref&&se(_.ref,null,d),p.push(d.ref,d.__c||y,d)),g==null&&y!=null&&(g=y),(v=!!(4&d.__u))||_.__k===d.__k?f=Ae(d,f,t,v):typeof d.type=="function"&&m!==void 0?f=m:y&&(f=y.nextSibling),d.__u&=-7);return n.__e=g,f}function Oe(t,e,n,o,s){var i,c,u,f,l,p=n.length,a=p,_=0;for(t.__k=new Array(s),i=0;i<s;i++)(c=e[i])!=null&&typeof c!="boolean"&&typeof c!="function"?(f=i+_,(c=t.__k[i]=typeof c=="string"||typeof c=="number"||typeof c=="bigint"||c.constructor==String?V(null,c,null,null,null):Q(c)?V(O,{children:c},null,null,null):c.constructor==null&&c.__b>0?V(c.type,c.props,c.key,c.ref?c.ref:null,c.__v):c).__=t,c.__b=t.__b+1,u=null,(l=c.__i=We(c,n,f,a))!=-1&&(a--,(u=n[l])&&(u.__u|=2)),u==null||u.__v==null?(l==-1&&(s>p?_--:s<p&&_++),typeof c.type!="function"&&(c.__u|=4)):l!=f&&(l==f-1?_--:l==f+1?_++:(l>f?_--:_++,c.__u|=4))):t.__k[i]=null;if(a)for(i=0;i<p;i++)(u=n[i])!=null&&(2&u.__u)==0&&(u.__e==o&&(o=D(u)),Le(u,u));return o}function Ae(t,e,n,o){var s,i;if(typeof t.type=="function"){for(s=t.__k,i=0;s&&i<s.length;i++)s[i]&&(s[i].__=t,e=Ae(s[i],e,n,o));return e}t.__e!=e&&(o&&(e&&t.type&&!e.parentNode&&(e=D(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function We(t,e,n,o){var s,i,c,u=t.key,f=t.type,l=e[n],p=l!=null&&(2&l.__u)==0;if(l===null&&t.key==null||p&&u==l.key&&f==l.type)return n;if(o>(p?1:0)){for(s=n-1,i=n+1;s>=0||i<e.length;)if((l=e[c=s>=0?s--:i++])!=null&&(2&l.__u)==0&&u==l.key&&f==l.type)return c}return-1}function fe(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||Me.test(e)?n:n+"px"}function B(t,e,n,o,s){var i,c;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof o=="string"&&(t.style.cssText=o=""),o)for(e in o)n&&e in n||fe(t.style,e,"");if(n)for(e in n)o&&n[e]==o[e]||fe(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")i=e!=(e=e.replace(xe,"$1")),c=e.toLowerCase(),e=c in t||e=="onFocusOut"||e=="onFocusIn"?c.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+i]=n,n?o?n.u=o.u:(n.u=ie,t.addEventListener(e,i?te:ee,i)):t.removeEventListener(e,i?te:ee,i);else{if(s=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function pe(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=ie++;else if(e.t<n.u)return;return n(k.event?k.event(e):e)}}}function ae(t,e,n,o,s,i,c,u,f,l){var p,a,_,d,y,g,m,v,w,N,S,A,j,_e,q,I,Y,x=e.type;if(e.constructor!=null)return null;128&n.__u&&(f=!!(32&n.__u),i=[u=e.__e=n.__e]),(p=k.__b)&&p(e);e:if(typeof x=="function")try{if(v=e.props,w="prototype"in x&&x.prototype.render,N=(p=x.contextType)&&o[p.__c],S=p?N?N.props.value:p.__:o,n.__c?m=(a=e.__c=n.__c).__=a.__E:(w?e.__c=a=new x(v,S):(e.__c=a=new R(v,S),a.constructor=x,a.render=Be),N&&N.sub(a),a.props=v,a.state||(a.state={}),a.context=S,a.__n=o,_=a.__d=!0,a.__h=[],a._sb=[]),w&&a.__s==null&&(a.__s=a.state),w&&x.getDerivedStateFromProps!=null&&(a.__s==a.state&&(a.__s=P({},a.__s)),P(a.__s,x.getDerivedStateFromProps(v,a.__s))),d=a.props,y=a.state,a.__v=e,_)w&&x.getDerivedStateFromProps==null&&a.componentWillMount!=null&&a.componentWillMount(),w&&a.componentDidMount!=null&&a.__h.push(a.componentDidMount);else{if(w&&x.getDerivedStateFromProps==null&&v!==d&&a.componentWillReceiveProps!=null&&a.componentWillReceiveProps(v,S),!a.__e&&a.shouldComponentUpdate!=null&&a.shouldComponentUpdate(v,a.__s,S)===!1||e.__v==n.__v){for(e.__v!=n.__v&&(a.props=v,a.state=a.__s,a.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(H){H&&(H.__=e)}),A=0;A<a._sb.length;A++)a.__h.push(a._sb[A]);a._sb=[],a.__h.length&&c.push(a);break e}a.componentWillUpdate!=null&&a.componentWillUpdate(v,a.__s,S),w&&a.componentDidUpdate!=null&&a.__h.push(function(){a.componentDidUpdate(d,y,g)})}if(a.context=S,a.props=v,a.__P=t,a.__e=!1,j=k.__r,_e=0,w){for(a.state=a.__s,a.__d=!1,j&&j(e),p=a.render(a.props,a.state,a.context),q=0;q<a._sb.length;q++)a.__h.push(a._sb[q]);a._sb=[]}else do a.__d=!1,j&&j(e),p=a.render(a.props,a.state,a.context),a.state=a.__s;while(a.__d&&++_e<25);a.state=a.__s,a.getChildContext!=null&&(o=P(P({},o),a.getChildContext())),w&&!_&&a.getSnapshotBeforeUpdate!=null&&(g=a.getSnapshotBeforeUpdate(d,y)),I=p,p!=null&&p.type===O&&p.key==null&&(I=He(p.props.children)),u=$e(t,Q(I)?I:[I],e,n,o,s,i,c,u,f,l),a.base=e.__e,e.__u&=-161,a.__h.length&&c.push(a),m&&(a.__E=a.__=null)}catch(H){if(e.__v=null,f||i!=null)if(H.then){for(e.__u|=f?160:128;u&&u.nodeType==8&&u.nextSibling;)u=u.nextSibling;i[i.indexOf(u)]=null,e.__e=u}else{for(Y=i.length;Y--;)oe(i[Y]);ne(e)}else e.__e=n.__e,e.__k=n.__k,H.then||ne(e);k.__e(H,e,n)}else i==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):u=e.__e=qe(n.__e,e,n,o,s,i,c,f,l);return(p=k.diffed)&&p(e),128&e.__u?void 0:u}function ne(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(ne)}function Te(t,e,n){for(var o=0;o<n.length;o++)se(n[o],n[++o],n[++o]);k.__c&&k.__c(e,t),t.some(function(s){try{t=s.__h,s.__h=[],t.some(function(i){i.call(s)})}catch(i){k.__e(i,s.__v)}})}function He(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:Q(t)?t.map(He):P({},t)}function qe(t,e,n,o,s,i,c,u,f){var l,p,a,_,d,y,g,m=n.props,v=e.props,w=e.type;if(w=="svg"?s="http://www.w3.org/2000/svg":w=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),i!=null){for(l=0;l<i.length;l++)if((d=i[l])&&"setAttribute"in d==!!w&&(w?d.localName==w:d.nodeType==3)){t=d,i[l]=null;break}}if(t==null){if(w==null)return document.createTextNode(v);t=document.createElementNS(s,w,v.is&&v),u&&(k.__m&&k.__m(e,i),u=!1),i=null}if(w==null)m===v||u&&t.data==v||(t.data=v);else{if(i=i&&G.call(t.childNodes),m=n.props||M,!u&&i!=null)for(m={},l=0;l<t.attributes.length;l++)m[(d=t.attributes[l]).name]=d.value;for(l in m)if(d=m[l],l!="children"){if(l=="dangerouslySetInnerHTML")a=d;else if(!(l in v)){if(l=="value"&&"defaultValue"in v||l=="checked"&&"defaultChecked"in v)continue;B(t,l,null,d,s)}}for(l in v)d=v[l],l=="children"?_=d:l=="dangerouslySetInnerHTML"?p=d:l=="value"?y=d:l=="checked"?g=d:u&&typeof d!="function"||m[l]===d||B(t,l,d,m[l],s);if(p)u||a&&(p.__html==a.__html||p.__html==t.innerHTML)||(t.innerHTML=p.__html),e.__k=[];else if(a&&(t.innerHTML=""),$e(e.type=="template"?t.content:t,Q(_)?_:[_],e,n,o,w=="foreignObject"?"http://www.w3.org/1999/xhtml":s,i,c,i?i[0]:n.__k&&D(n,0),u,f),i!=null)for(l=i.length;l--;)oe(i[l]);u||(l="value",w=="progress"&&y==null?t.removeAttribute("value"):y!=null&&(y!==t[l]||w=="progress"&&!y||w=="option"&&y!=m[l])&&B(t,l,y,m[l],s),l="checked",g!=null&&g!=t[l]&&B(t,l,g,m[l],s))}return t}function se(t,e,n){try{if(typeof t=="function"){var o=typeof t.__u=="function";o&&t.__u(),o&&e==null||(t.__u=t(e))}else t.current=e}catch(s){k.__e(s,n)}}function Le(t,e,n){var o,s;if(k.unmount&&k.unmount(t),(o=t.ref)&&(o.current&&o.current!=t.__e||se(o,null,e)),(o=t.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(i){k.__e(i,e)}o.base=o.__P=null}if(o=t.__k)for(s=0;s<o.length;s++)o[s]&&Le(o[s],e,n||typeof t.type!="function");n||oe(t.__e),t.__c=t.__=t.__e=void 0}function Be(t,e,n){return this.constructor(t,n)}function Ve(t,e,n){var o,s,i,c;e==document&&(e=document.documentElement),k.__&&k.__(t,e),s=(o=!1)?null:e.__k,i=[],c=[],ae(e,t=e.__k=Ue(O,null,[t]),s||M,M,e.namespaceURI,s?null:e.firstChild?G.call(e.childNodes):null,i,s?s.__e:e.firstChild,o,c),Te(i,t,c)}G=je.slice,k={__e:function(t,e,n,o){for(var s,i,c;e=e.__;)if((s=e.__c)&&!s.__)try{if((i=s.constructor)&&i.getDerivedStateFromError!=null&&(s.setState(i.getDerivedStateFromError(t)),c=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(t,o||{}),c=s.__d),c)return s.__E=s}catch(u){t=u}throw t}},Ee=0,R.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=P({},this.state),typeof t=="function"&&(t=t(P({},n),this.props)),t&&P(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),de(this))},R.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),de(this))},R.prototype.render=O,T=[],Ce=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Se=function(t,e){return t.__v.__b-e.__v.__b},z.__r=0,xe=/(PointerCapture)$|Capture$/i,ie=0,ee=pe(!1),te=pe(!0);var Re=0;function r(t,e,n,o,s,i){e||(e={});var c,u,f=e;if("ref"in f)for(u in f={},e)u=="ref"?c=e[u]:f[u]=e[u];var l={type:t,props:f,key:n,ref:c,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Re,__i:-1,__u:0,__source:s,__self:i};if(typeof t=="function"&&(c=t.defaultProps))for(u in c)f[u]===void 0&&(f[u]=c[u]);return k.vnode&&k.vnode(l),l}var U,E,Z,he,J=0,De=[],C=k,me=C.__b,ye=C.__r,ve=C.diffed,ge=C.__c,be=C.unmount,we=C.__;function le(t,e){C.__h&&C.__h(E,t,J||e),J=0;var n=E.__H||(E.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function b(t){return J=1,Ke(Ie,t)}function Ke(t,e,n){var o=le(U++,2);if(o.t=t,!o.__c&&(o.__=[Ie(void 0,e),function(u){var f=o.__N?o.__N[0]:o.__[0],l=o.t(f,u);f!==l&&(o.__N=[l,o.__[1]],o.__c.setState({}))}],o.__c=E,!E.__f)){var s=function(u,f,l){if(!o.__c.__H)return!0;var p=o.__c.__H.__.filter(function(_){return!!_.__c});if(p.every(function(_){return!_.__N}))return!i||i.call(this,u,f,l);var a=o.__c.props!==u;return p.forEach(function(_){if(_.__N){var d=_.__[0];_.__=_.__N,_.__N=void 0,d!==_.__[0]&&(a=!0)}}),i&&i.call(this,u,f,l)||a};E.__f=!0;var i=E.shouldComponentUpdate,c=E.componentWillUpdate;E.componentWillUpdate=function(u,f,l){if(this.__e){var p=i;i=void 0,s(u,f,l),i=p}c&&c.call(this,u,f,l)},E.shouldComponentUpdate=s}return o.__N||o.__}function F(t,e){var n=le(U++,3);!C.__s&&Fe(n.__H,e)&&(n.__=t,n.u=e,E.__H.__h.push(n))}function ze(t,e){var n=le(U++,7);return Fe(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function Je(t,e){return J=8,ze(function(){return t},e)}function Ge(){for(var t;t=De.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(K),t.__H.__h.forEach(re),t.__H.__h=[]}catch(e){t.__H.__h=[],C.__e(e,t.__v)}}C.__b=function(t){E=null,me&&me(t)},C.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),we&&we(t,e)},C.__r=function(t){ye&&ye(t),U=0;var e=(E=t.__c).__H;e&&(Z===E?(e.__h=[],E.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.forEach(K),e.__h.forEach(re),e.__h=[],U=0)),Z=E},C.diffed=function(t){ve&&ve(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(De.push(e)!==1&&he===C.requestAnimationFrame||((he=C.requestAnimationFrame)||Qe)(Ge)),e.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Z=E=null},C.__c=function(t,e){e.some(function(n){try{n.__h.forEach(K),n.__h=n.__h.filter(function(o){return!o.__||re(o)})}catch(o){e.some(function(s){s.__h&&(s.__h=[])}),e=[],C.__e(o,n.__v)}}),ge&&ge(t,e)},C.unmount=function(t){be&&be(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{K(o)}catch(s){e=s}}),n.__H=void 0,e&&C.__e(e,n.__v))};var ke=typeof requestAnimationFrame=="function";function Qe(t){var e,n=function(){clearTimeout(o),ke&&cancelAnimationFrame(e),setTimeout(t)},o=setTimeout(n,35);ke&&(e=requestAnimationFrame(n))}function K(t){var e=E,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),E=e}function re(t){var e=E;t.__c=t.__(),E=e}function Fe(t,e){return!t||t.length!==e.length||e.some(function(n,o){return n!==t[o]})}function Ie(t,e){return typeof e=="function"?e(t):e}const W=({children:t,className:e="",style:n={},title:o=""})=>{const[s,i]=b(window.location.pathname||"/");F(()=>{const l=()=>i(window.location.pathname||"/");return window.addEventListener("popstate",l),()=>window.removeEventListener("popstate",l)},[]);const c=[{href:"/home",label:"Home"},{href:"/alarms",label:"Alarm"},{href:"/nap",label:"Nap"},{href:"/settings",label:"Settings"}];function u(l){return l==="/home"&&(s==="/"||s==="/home")||s===l?!0:s.startsWith(l+"/")}function f(l){const a=l.currentTarget.getAttribute("href");!a||!a.startsWith("/")||(l.preventDefault(),a!==window.location.pathname&&(history.pushState(null,"",a),window.dispatchEvent(new PopStateEvent("popstate")),i(a)))}return r("div",{className:`page ${e}`,style:n,children:[r("header",{className:"page-header",children:[o?r("h1",{className:"page-title",children:o}):null,r("nav",{className:"nav-bar","aria-label":"Primary",children:c.map(l=>r("a",{className:`nav-link ${u(l.href)?"active":""}`,href:l.href,onClick:f,children:l.label},l.href))})]}),r("main",{className:"page-content",children:t})]})},h=({children:t,justify:e="center",direction:n="row",className:o="",onClick:s})=>{const c={display:"flex",justifyContent:e==="left"?"flex-start":e==="right"?"flex-end":"center",flexDirection:n};return r("div",{className:`box ${o}`,style:c,onClick:s,children:t})},X=({text:t="",onClick:e=()=>{},className:n="",disabled:o=!1,type:s="button"})=>r("button",{type:s,className:`button ${n}`,onClick:e,disabled:o,children:t}),Xe=({navigate:t})=>{const[e,n]=b("");return r(W,{title:"E-Ink Clock",children:r(h,{direction:"column",children:[r(h,{direction:"row",justify:"center",children:r("p",{children:"Configure your e-ink Clock"})}),r(h,{direction:"row",justify:"center",children:r(X,{onClick:async()=>{try{const s=await fetch("/api/alarms");if(s.ok)n("OK");else{const i=await s.text();n(`Error: ${i}`)}}catch(s){n(`Error: ${s.message}`)}},text:"Test Connection"})}),r(h,{direction:"row",justify:"center",children:e&&r("p",{children:e})})]})})},Ye=({headers:t=[],children:e})=>r("table",{className:"list-table",role:"table",children:[t&&t.length>0?r("thead",{children:r("tr",{children:t.map((n,o)=>r("th",{className:"list-header-cell",children:n},o))})}):null,r("tbody",{children:e})]}),ce=()=>{const[t,e]=b(1);return F(()=>{const n=setInterval(()=>e(o=>o%4+1),800);return()=>clearInterval(n)},[]),r("div",{className:"loading",children:`Loading ${".".repeat(t)}`})},Ze=({alarm:t,navigate:e})=>{const n=()=>{e(`/alarms/${t.id}`)};return r("tr",{className:"list-row",children:[r("td",{className:"list-cell",children:t.name}),r("td",{className:"list-cell",children:t.time}),r("td",{className:"list-cell",children:[t.days[0]&&"M  ",t.days[1]&&"Tu  ",t.days[2]&&"W  ",t.days[3]&&"Th  ",t.days[4]&&"F  ",t.days[5]&&"Sa  ",t.days[6]&&"Su"]}),r("td",{className:"list-cell",children:t.enabled?"✔":"✖"}),r("td",{className:"list-cell",children:r(X,{text:"Edit",onClick:()=>n()})})]})},et=({navigate:t})=>{const[e,n]=b(!0),[o,s]=b([]),[i,c]=b(""),[u,f]=b("");F(()=>{n(!0),(async()=>{let _=0;for(;_<3;)try{const y=await(await fetch("/api/alarms")).json();s(y),n(!1);return}catch(d){_++,console.error(d instanceof Error?d.message:String(d)),_<3&&await new Promise(y=>setTimeout(y,2e3))}c("Failed to retrieve alarms after multiple attempts"),n(!1)})()},[]);const l=async()=>{f("");let a=0;for(;a<3;)try{const d=await(await fetch("/api/alarms/create",{method:"POST",headers:{"Content-Type":"application/json"}})).json();if(d.success&&d.alarm_id){t(`/alarms/${d.alarm_id}`);return}console.error("Create failed:",d.error),a++,a<3&&await new Promise(y=>setTimeout(y,2e3))}catch(_){console.error(_ instanceof Error?_.message:String(_)),a++,a<3&&await new Promise(d=>setTimeout(d,2e3))}f("Failed to create alarm after multiple attempts")},p=["Alarm","Time","Days","Enabled","Actions"];return r(W,{title:"E-Ink Clock",children:i?r(h,{children:r("p",{className:"error",children:i})}):e?r(h,{children:r(ce,{})}):r("div",{children:[r(h,{justify:"left",children:r("span",{className:"page-subtitle",children:"Alarms:"})}),r(h,{children:o.length>0?r(Ye,{headers:p,children:o.map(a=>r(Ze,{alarm:a,navigate:t}))}):r("p",{children:"No alarms configured"})}),r(h,{direction:"column",children:[r(h,{direction:"row",justify:"right",children:r(X,{text:"Add Alarm",onClick:l})}),r(h,{direction:"row",justify:"right",children:u&&r("span",{className:"error-msg",style:"margin-top: 8px",children:u})})]})]})})},$=({value:t,onSave:e,param:n})=>{const[o,s]=b(!1),[i,c]=b(t),[u,f]=b(""),l=()=>{c(t),s(!0),f("")},p=()=>{s(!1),f(""),c(t)},a=async()=>{const _=await e(n,i);_===""?(s(!1),f("")):f(_)};return o?r(h,{className:"editable-input",direction:"column",children:[r(h,{direction:"row",children:[r("input",{type:"checkbox",checked:i,onInput:_=>c(_.target.checked),onKeyDown:_=>{_.key==="Enter"&&a(),_.key==="Escape"&&p()}}),r("button",{type:"button",onClick:a,style:"margin-left:8px",children:"✔"}),r("button",{type:"button",onClick:p,style:"margin-left:8px",children:"✖"})]}),u&&r("span",{className:"error-msg",children:u})]}):r(h,{justify:"left",className:"editable-input",onClick:l,children:i?"✔":"✖"})},L=({value:t,onSave:e,param:n,min:o,max:s})=>{const[i,c]=b(!1),[u,f]=b(t),[l,p]=b(""),a=()=>{f(t),c(!0),p("")},_=()=>{c(!1),f(t),p("")},d=m=>o!==void 0&&m<o?`Value must be ≥ ${o}`:s!==void 0&&m>s?`Value must be ≤ ${s}`:"",y=m=>{const v=Number(m.target.value);f(v),p(d(v))},g=async()=>{const m=d(u);if(m!==""){p(m);return}const v=await e(n,u);v===""?(c(!1),p("")):p(v)};return i?r(h,{className:"editable-input",direction:"column",children:[r(h,{direction:"row",children:[r("input",{type:"number",value:u,onInput:y,onKeyDown:m=>{m.key==="Enter"&&g(),m.key==="Escape"&&_()}}),r("button",{type:"button",onClick:g,disabled:!!l,style:"margin-left:8px",children:"✔"}),r("button",{type:"button",onClick:_,style:"margin-left:8px",children:"✖"})]}),l&&r("span",{className:"error-msg",children:l})]}):r(h,{justify:"left",className:"editable-input",onClick:a,children:t})},tt=({value:t,param:e,min:n,max:o,onSave:s})=>{const[i,c]=b(!1),[u,f]=b([...t]),[l,p]=b(""),[a,_]=b(""),d=()=>{f([...t]),p(""),c(!0),_("")},y=()=>{c(!1),f([...t]),_("")},g=N=>n!==void 0&&N<n?`Value must be ≥ ${n}`:o!==void 0&&N>o?`Value must be ≤ ${o}`:"",m=()=>{if(l==="")return;const N=g(l);if(N){_(N);return}f(S=>[...S,l].sort((A,j)=>A-j)),p(""),_("")},v=N=>{f(S=>S.filter((A,j)=>j!==N))},w=async()=>{const N=await s(e,u);N===""?(c(!1),_("")):_(N)};return i?r(h,{className:"editable-input",direction:"column",children:[u.map((N,S)=>r(h,{direction:"row",children:[r("span",{children:N}),r("button",{type:"button",onClick:()=>v(S),style:"margin-left:8px",children:"✖"})]},S)),r(h,{direction:"row",children:[r("input",{type:"number",value:l,onInput:N=>p(Number(N.target.value)),onKeyDown:N=>{N.key==="Enter"&&m(),N.key==="Escape"&&p("")},placeholder:"Add number"}),r("button",{type:"button",onClick:m,style:"margin-left:8px",children:"➕"})]}),r(h,{direction:"row",children:[r("button",{type:"button",onClick:w,style:"margin-right:8px",children:"✔ Save"}),r("button",{type:"button",onClick:y,children:"✖ Cancel"})]}),a&&r("span",{className:"error-msg",children:a})]}):r(h,{justify:"left",className:"editable-input",onClick:d,children:t.join(", ")})},nt=()=>{const[t,e]=b(),[n,o]=b(!0),[s,i]=b("");F(()=>{(async()=>{try{const l=await(await fetch("/api/timer")).json();e(l)}catch(f){i("Failed to retrieve nap settings"),console.error(f instanceof Error?f.message:String(f))}finally{o(!1)}})()},[]);const c=async(u,f)=>{try{return(await(await fetch("/api/timer/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({param:u,value:f})})).json()).success?(e(a=>a&&{...a,[u]:f}),""):"Update failed"}catch(l){return console.error(l),"Update failed"}};return r(W,{title:"Nap Settings",children:s?r(h,{children:r("p",{className:"error",children:s})}):n?r(h,{children:r(ce,{})}):t&&r(O,{children:[r(h,{justify:"left",children:r("span",{className:"page-subtitle",children:"Nap Settings:"})}),r(h,{justify:"left",children:[r("span",{children:"Tone: "}),r($,{value:t.tone,param:"tone",onSave:c})]}),r(h,{justify:"left",children:[r("span",{children:"Vibrate: "}),r($,{value:t.vibrate,param:"vibrate",onSave:c})]}),r(h,{justify:"left",children:[r("span",{children:"Audio: "}),r($,{value:t.audio,param:"audio",onSave:c})]}),r(h,{justify:"left",children:[r("span",{children:"Ramp: "}),r($,{value:t.ramp,param:"ramp",onSave:c})]}),r(h,{justify:"left",children:[r("span",{children:"Frequency: "}),r(L,{value:t.frequency,param:"frequency",min:20,max:2e4,onSave:c})]}),r(h,{justify:"left",children:[r("span",{children:"Volume: "}),r(L,{value:t.volume,param:"volume",min:0,max:100,onSave:c})]}),r(h,{justify:"left",children:[r("span",{children:"Nap Intervals (minutes): "}),r(tt,{value:t.intervals,param:"intervals",min:1,max:120,onSave:c})]})]})})},rt=({navigate:t})=>r(W,{title:"E-Ink Clock",children:r("p",{children:"Settings"})}),Ne=({value:t,onSave:e,param:n,valid:o})=>{const[s,i]=b(!1),[c,u]=b(t),[f,l]=b(""),p=()=>{u(t),i(!0),l("")},a=()=>{i(!1),u(t),l("")},_=g=>o&&!o.includes(g.trim())?`Valid values: ${o.join(", ")}`:"",d=g=>{const m=g.target.value;u(m),l(_(m))},y=async()=>{const g=_(c);if(g){l(g);return}try{const m=await e(n,c.trim());m===""?(i(!1),l("")):l(m)}catch{l("Error")}};return s?r(h,{className:"editable-input",direction:"column",children:[r(h,{direction:"row",children:[r("input",{type:"text",value:c,onInput:d,onKeyDown:g=>{g.key==="Enter"&&y(),g.key==="Escape"&&a()}}),r("button",{type:"button",onClick:y,disabled:!!f,style:"margin-left:8px",children:"✔"}),r("button",{type:"button",onClick:a,style:"margin-left:8px",children:"✖"})]}),f&&r("span",{className:"error-msg",children:f})]}):r(h,{justify:"left",className:"editable-input",onClick:p,children:c})},it=({value:t,onSave:e,param:n})=>{const[o,s]=b(!1),[i,c]=b(t),[u,f]=b(""),l=()=>{c(t),s(!0),f("")},p=()=>{s(!1),f(""),c(t)},a=async()=>{const _=await e(n,i);_===""?(s(!1),f("")):f(_)};return o?r(h,{className:"editable-input",children:[r("div",{children:r("div",{children:[r("span",{children:"M:"}),r("input",{type:"checkbox",checked:i[0],onChange:_=>{const d=i;d[0]=_.target.checked,c(d)}}),r("span",{children:"Tu:"}),r("input",{type:"checkbox",checked:i[1],onChange:_=>{const d=i;d[1]=_.target.checked,c(d)}}),r("span",{children:"W:"}),r("input",{type:"checkbox",checked:i[2],onChange:_=>{const d=i;d[2]=_.target.checked,c(d)}}),r("span",{children:"Th:"}),r("input",{type:"checkbox",checked:i[3],onChange:_=>{const d=i;d[3]=_.target.checked,c(d)}}),r("span",{children:"F:"}),r("input",{type:"checkbox",checked:i[4],onChange:_=>{const d=i;d[4]=_.target.checked,c(d)}}),r("span",{children:"Sa:"}),r("input",{type:"checkbox",checked:i[5],onChange:_=>{const d=i;d[5]=_.target.checked,c(d)}}),r("span",{children:"Su:"}),r("input",{type:"checkbox",checked:i[6],onChange:_=>{const d=i;d[6]=_.target.checked,c(d)}}),r("button",{type:"button",onClick:a,style:"margin-left:8px",children:"✔"}),r("button",{type:"button",onClick:p,style:"margin-left:8px",children:"✖"})]})}),r(h,{children:u&&r("span",{className:"error-msg",children:u})})]}):r(h,{justify:"left",className:"editable-input",onClick:l,children:[i[0]&&"M  ",i[1]&&"Tu  ",i[2]&&"W  ",i[3]&&"Th  ",i[4]&&"F  ",i[5]&&"Sa  ",i[6]&&"Su"]})},ot=({navigate:t})=>{const[e,n]=b(),[o,s]=b(!0),[i,c]=b(""),[u,f]=b("");F(()=>{s(!0),(async()=>{try{const d=window.location.pathname.split("/")[2],g=await(await fetch(`/api/alarms/${d}`)).json();n(g),s(!1)}catch(_){c("Failed to retrieve alarm details"),console.error(_ instanceof Error?_.message:String(_))}})()},[]);const l=async()=>{if(!e||!confirm("Are you sure you want to delete this alarm?"))return;let a=0;for(;a<3;)try{const d=await(await fetch(`/api/alarms/${e.id}/delete`,{method:"POST",headers:{"Content-Type":"application/json"}})).json();if(d.success){t("/alarms");return}else{console.error("Delete failed:",d.error),a++,a<3&&await new Promise(y=>setTimeout(y,2e3));continue}}catch(_){console.error(_ instanceof Error?_.message:String(_)),a++,a<3&&await new Promise(d=>setTimeout(d,2e3))}f("Failed to delete alarm after multiple attempts")},p=async(a,_)=>{const d={param:a,value:_};let y=0;for(;y<3;)try{const m=await(await fetch(`/api/alarms/${e?.id}/update`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})).json();if(m.success)return n(v=>v&&{...v,[a]:_}),"";if(m.error==="failed"){console.log("updateAlarm attempt failed. Param:",a,"Value:",_),y++,y<3&&await new Promise(v=>setTimeout(v,2e3));continue}return console.error("updateAlarm error:",m.error),"Alarm edit failed"}catch{y++,y<3&&await new Promise(g=>setTimeout(g,2e3))}return"Alarm edit failed after multiple attempts"};return r(W,{title:"E-Ink Clock",children:i?r(h,{children:r("p",{className:"error",children:i})}):o?r(h,{children:r(ce,{})}):r("div",{children:[r(h,{justify:"left",children:r("span",{className:"page-subtitle",children:"Alarm Details:"})}),r(h,{justify:"left",children:[r("span",{children:"Name: "}),e&&r(Ne,{value:e.name,param:"name",onSave:p})]}),r(h,{justify:"left",children:[r("span",{children:"Hour: "}),e&&r(L,{value:e.hour,min:1,max:12,param:"hour",onSave:p})]}),r(h,{justify:"left",children:[r("span",{children:"Minute: "}),e&&r(L,{value:e.minute,param:"minute",min:1,max:59,onSave:p})]}),r(h,{justify:"left",children:[r("span",{children:"AM/PM: "}),e&&r(Ne,{value:e.am_pm,param:"am_pm",valid:["AM","PM"],onSave:p})]}),r(h,{justify:"left",children:[r("span",{children:"Days: "}),e&&r(it,{value:e.days,param:"days",onSave:p})]}),r(h,{justify:"left",children:[r("span",{children:"Enabled: "}),e&&r($,{value:e.enabled,param:"enabled",onSave:p})]}),r(h,{justify:"left",children:[r("span",{children:"Tone: "}),e&&r($,{value:e.tone,param:"tone",onSave:p})]}),r(h,{justify:"left",children:[r("span",{children:"Tone Frequency: "}),e&&r(L,{value:e.frequency,param:"frequency",min:200,max:2400,onSave:p})]}),r(h,{justify:"left",children:[r("span",{children:"Audio: "}),e&&r($,{value:e.audio,param:"audio",onSave:p})]}),r(h,{justify:"left",children:[r("span",{children:"Ramp: "}),e&&r($,{value:e.ramp,param:"ramp",onSave:p})]}),r(h,{justify:"left",children:[r("span",{children:"Volume: "}),e&&r(L,{value:e.volume,min:0,max:100,param:"volume",onSave:p})]}),r(h,{direction:"column",justify:"center",children:[r(X,{text:"Delete Alarm",onClick:l}),u&&r("span",{className:"error-msg",children:u})]})]})})};function at(){const[t,e]=b(window.location.pathname||"/"),n=Je(o=>{o!==window.location.pathname&&(history.pushState(null,"",o),e(o))},[]);return F(()=>{const o=()=>e(window.location.pathname);return window.addEventListener("popstate",o),()=>window.removeEventListener("popstate",o)},[]),{path:t,navigate:n}}const st=()=>{const{path:t,navigate:e}=at();return t==="/alarms"?r(et,{navigate:e}):t.startsWith("/alarms/")?r(ot,{navigate:e}):t==="/nap"?r(nt,{navigate:e}):t==="/settings"?r(rt,{navigate:e}):r(Xe,{navigate:e})},lt=document.getElementById("root");Ve(r(st,{}),lt);
