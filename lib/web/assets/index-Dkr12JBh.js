(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(a){if(a.ep)return;a.ep=!0;const r=n(a);fetch(a.href,r)}})();var G,b,Ee,A,_e,Ne,Ce,xe,re,Z,ee,D={},Se=[],Me=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,J=Array.isArray;function x(t,e){for(var n in e)t[n]=e[n];return t}function oe(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Ue(t,e,n){var o,a,r,c={};for(r in e)r=="key"?o=e[r]:r=="ref"?a=e[r]:c[r]=e[r];if(arguments.length>2&&(c.children=arguments.length>3?G.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(r in t.defaultProps)c[r]===void 0&&(c[r]=t.defaultProps[r]);return q(t,c,o,a,null)}function q(t,e,n,o,a){var r={type:t,props:e,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:a??++Ee,__i:-1,__u:0};return a==null&&b.vnode!=null&&b.vnode(r),r}function Q(t){return t.children}function R(t,e){this.props=t,this.context=e}function T(t,e){if(e==null)return t.__?T(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?T(t):null}function Pe(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Pe(t)}}function ue(t){(!t.__d&&(t.__d=!0)&&A.push(t)&&!K.__r++||_e!=b.debounceRendering)&&((_e=b.debounceRendering)||Ne)(K)}function K(){for(var t,e,n,o,a,r,c,d=1;A.length;)A.length>d&&A.sort(Ce),t=A.shift(),d=A.length,t.__d&&(n=void 0,o=void 0,a=(o=(e=t).__v).__e,r=[],c=[],e.__P&&((n=x({},o)).__v=o.__v+1,b.vnode&&b.vnode(n),ie(e.__P,n,o,e.__n,e.__P.namespaceURI,32&o.__u?[a]:null,r,a??T(o),!!(32&o.__u),c),n.__v=o.__v,n.__.__k[n.__i]=n,Te(r,n,c),o.__e=o.__=null,n.__e!=a&&Pe(n)));K.__r=0}function Ae(t,e,n,o,a,r,c,d,f,s,p){var i,u,_,m,g,h,y,k=o&&o.__k||Se,S=e.length;for(f=We(n,e,k,f,S),i=0;i<S;i++)(_=n.__k[i])!=null&&(u=_.__i==-1?D:k[_.__i]||D,_.__i=i,h=ie(t,_,u,a,r,c,d,f,s,p),m=_.__e,_.ref&&u.ref!=_.ref&&(u.ref&&le(u.ref,null,_),p.push(_.ref,_.__c||m,_)),g==null&&m!=null&&(g=m),(y=!!(4&_.__u))||u.__k===_.__k?f=$e(_,f,t,y):typeof _.type=="function"&&h!==void 0?f=h:m&&(f=m.nextSibling),_.__u&=-7);return n.__e=g,f}function We(t,e,n,o,a){var r,c,d,f,s,p=n.length,i=p,u=0;for(t.__k=new Array(a),r=0;r<a;r++)(c=e[r])!=null&&typeof c!="boolean"&&typeof c!="function"?(f=r+u,(c=t.__k[r]=typeof c=="string"||typeof c=="number"||typeof c=="bigint"||c.constructor==String?q(null,c,null,null,null):J(c)?q(Q,{children:c},null,null,null):c.constructor==null&&c.__b>0?q(c.type,c.props,c.key,c.ref?c.ref:null,c.__v):c).__=t,c.__b=t.__b+1,d=null,(s=c.__i=Oe(c,n,f,i))!=-1&&(i--,(d=n[s])&&(d.__u|=2)),d==null||d.__v==null?(s==-1&&(a>p?u--:a<p&&u++),typeof c.type!="function"&&(c.__u|=4)):s!=f&&(s==f-1?u--:s==f+1?u++:(s>f?u--:u++,c.__u|=4))):t.__k[r]=null;if(i)for(r=0;r<p;r++)(d=n[r])!=null&&(2&d.__u)==0&&(d.__e==o&&(o=T(d)),He(d,d));return o}function $e(t,e,n,o){var a,r;if(typeof t.type=="function"){for(a=t.__k,r=0;a&&r<a.length;r++)a[r]&&(a[r].__=t,e=$e(a[r],e,n,o));return e}t.__e!=e&&(o&&(e&&t.type&&!e.parentNode&&(e=T(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Oe(t,e,n,o){var a,r,c,d=t.key,f=t.type,s=e[n],p=s!=null&&(2&s.__u)==0;if(s===null&&t.key==null||p&&d==s.key&&f==s.type)return n;if(o>(p?1:0)){for(a=n-1,r=n+1;a>=0||r<e.length;)if((s=e[c=a>=0?a--:r++])!=null&&(2&s.__u)==0&&d==s.key&&f==s.type)return c}return-1}function de(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||Me.test(e)?n:n+"px"}function W(t,e,n,o,a){var r,c;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof o=="string"&&(t.style.cssText=o=""),o)for(e in o)n&&e in n||de(t.style,e,"");if(n)for(e in n)o&&n[e]==o[e]||de(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")r=e!=(e=e.replace(xe,"$1")),c=e.toLowerCase(),e=c in t||e=="onFocusOut"||e=="onFocusIn"?c.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+r]=n,n?o?n.u=o.u:(n.u=re,t.addEventListener(e,r?ee:Z,r)):t.removeEventListener(e,r?ee:Z,r);else{if(a=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function fe(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=re++;else if(e.t<n.u)return;return n(b.event?b.event(e):e)}}}function ie(t,e,n,o,a,r,c,d,f,s){var p,i,u,_,m,g,h,y,k,S,P,M,j,ce,U,H,X,C=e.type;if(e.constructor!=null)return null;128&n.__u&&(f=!!(32&n.__u),r=[d=e.__e=n.__e]),(p=b.__b)&&p(e);e:if(typeof C=="function")try{if(y=e.props,k="prototype"in C&&C.prototype.render,S=(p=C.contextType)&&o[p.__c],P=p?S?S.props.value:p.__:o,n.__c?h=(i=e.__c=n.__c).__=i.__E:(k?e.__c=i=new C(y,P):(e.__c=i=new R(y,P),i.constructor=C,i.render=qe),S&&S.sub(i),i.props=y,i.state||(i.state={}),i.context=P,i.__n=o,u=i.__d=!0,i.__h=[],i._sb=[]),k&&i.__s==null&&(i.__s=i.state),k&&C.getDerivedStateFromProps!=null&&(i.__s==i.state&&(i.__s=x({},i.__s)),x(i.__s,C.getDerivedStateFromProps(y,i.__s))),_=i.props,m=i.state,i.__v=e,u)k&&C.getDerivedStateFromProps==null&&i.componentWillMount!=null&&i.componentWillMount(),k&&i.componentDidMount!=null&&i.__h.push(i.componentDidMount);else{if(k&&C.getDerivedStateFromProps==null&&y!==_&&i.componentWillReceiveProps!=null&&i.componentWillReceiveProps(y,P),!i.__e&&i.shouldComponentUpdate!=null&&i.shouldComponentUpdate(y,i.__s,P)===!1||e.__v==n.__v){for(e.__v!=n.__v&&(i.props=y,i.state=i.__s,i.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function($){$&&($.__=e)}),M=0;M<i._sb.length;M++)i.__h.push(i._sb[M]);i._sb=[],i.__h.length&&c.push(i);break e}i.componentWillUpdate!=null&&i.componentWillUpdate(y,i.__s,P),k&&i.componentDidUpdate!=null&&i.__h.push(function(){i.componentDidUpdate(_,m,g)})}if(i.context=P,i.props=y,i.__P=t,i.__e=!1,j=b.__r,ce=0,k){for(i.state=i.__s,i.__d=!1,j&&j(e),p=i.render(i.props,i.state,i.context),U=0;U<i._sb.length;U++)i.__h.push(i._sb[U]);i._sb=[]}else do i.__d=!1,j&&j(e),p=i.render(i.props,i.state,i.context),i.state=i.__s;while(i.__d&&++ce<25);i.state=i.__s,i.getChildContext!=null&&(o=x(x({},o),i.getChildContext())),k&&!u&&i.getSnapshotBeforeUpdate!=null&&(g=i.getSnapshotBeforeUpdate(_,m)),H=p,p!=null&&p.type===Q&&p.key==null&&(H=je(p.props.children)),d=Ae(t,J(H)?H:[H],e,n,o,a,r,c,d,f,s),i.base=e.__e,e.__u&=-161,i.__h.length&&c.push(i),h&&(i.__E=i.__=null)}catch($){if(e.__v=null,f||r!=null)if($.then){for(e.__u|=f?160:128;d&&d.nodeType==8&&d.nextSibling;)d=d.nextSibling;r[r.indexOf(d)]=null,e.__e=d}else{for(X=r.length;X--;)oe(r[X]);te(e)}else e.__e=n.__e,e.__k=n.__k,$.then||te(e);b.__e($,e,n)}else r==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):d=e.__e=Be(n.__e,e,n,o,a,r,c,f,s);return(p=b.diffed)&&p(e),128&e.__u?void 0:d}function te(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(te)}function Te(t,e,n){for(var o=0;o<n.length;o++)le(n[o],n[++o],n[++o]);b.__c&&b.__c(e,t),t.some(function(a){try{t=a.__h,a.__h=[],t.some(function(r){r.call(a)})}catch(r){b.__e(r,a.__v)}})}function je(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:J(t)?t.map(je):x({},t)}function Be(t,e,n,o,a,r,c,d,f){var s,p,i,u,_,m,g,h=n.props,y=e.props,k=e.type;if(k=="svg"?a="http://www.w3.org/2000/svg":k=="math"?a="http://www.w3.org/1998/Math/MathML":a||(a="http://www.w3.org/1999/xhtml"),r!=null){for(s=0;s<r.length;s++)if((_=r[s])&&"setAttribute"in _==!!k&&(k?_.localName==k:_.nodeType==3)){t=_,r[s]=null;break}}if(t==null){if(k==null)return document.createTextNode(y);t=document.createElementNS(a,k,y.is&&y),d&&(b.__m&&b.__m(e,r),d=!1),r=null}if(k==null)h===y||d&&t.data==y||(t.data=y);else{if(r=r&&G.call(t.childNodes),h=n.props||D,!d&&r!=null)for(h={},s=0;s<t.attributes.length;s++)h[(_=t.attributes[s]).name]=_.value;for(s in h)if(_=h[s],s!="children"){if(s=="dangerouslySetInnerHTML")i=_;else if(!(s in y)){if(s=="value"&&"defaultValue"in y||s=="checked"&&"defaultChecked"in y)continue;W(t,s,null,_,a)}}for(s in y)_=y[s],s=="children"?u=_:s=="dangerouslySetInnerHTML"?p=_:s=="value"?m=_:s=="checked"?g=_:d&&typeof _!="function"||h[s]===_||W(t,s,_,h[s],a);if(p)d||i&&(p.__html==i.__html||p.__html==t.innerHTML)||(t.innerHTML=p.__html),e.__k=[];else if(i&&(t.innerHTML=""),Ae(e.type=="template"?t.content:t,J(u)?u:[u],e,n,o,k=="foreignObject"?"http://www.w3.org/1999/xhtml":a,r,c,r?r[0]:n.__k&&T(n,0),d,f),r!=null)for(s=r.length;s--;)oe(r[s]);d||(s="value",k=="progress"&&m==null?t.removeAttribute("value"):m!=null&&(m!==t[s]||k=="progress"&&!m||k=="option"&&m!=h[s])&&W(t,s,m,h[s],a),s="checked",g!=null&&g!=t[s]&&W(t,s,g,h[s],a))}return t}function le(t,e,n){try{if(typeof t=="function"){var o=typeof t.__u=="function";o&&t.__u(),o&&e==null||(t.__u=t(e))}else t.current=e}catch(a){b.__e(a,n)}}function He(t,e,n){var o,a;if(b.unmount&&b.unmount(t),(o=t.ref)&&(o.current&&o.current!=t.__e||le(o,null,e)),(o=t.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(r){b.__e(r,e)}o.base=o.__P=null}if(o=t.__k)for(a=0;a<o.length;a++)o[a]&&He(o[a],e,n||typeof t.type!="function");n||oe(t.__e),t.__c=t.__=t.__e=void 0}function qe(t,e,n){return this.constructor(t,n)}function Re(t,e,n){var o,a,r,c;e==document&&(e=document.documentElement),b.__&&b.__(t,e),a=(o=!1)?null:e.__k,r=[],c=[],ie(e,t=e.__k=Ue(Q,null,[t]),a||D,D,e.namespaceURI,a?null:e.firstChild?G.call(e.childNodes):null,r,a?a.__e:e.firstChild,o,c),Te(r,t,c)}G=Se.slice,b={__e:function(t,e,n,o){for(var a,r,c;e=e.__;)if((a=e.__c)&&!a.__)try{if((r=a.constructor)&&r.getDerivedStateFromError!=null&&(a.setState(r.getDerivedStateFromError(t)),c=a.__d),a.componentDidCatch!=null&&(a.componentDidCatch(t,o||{}),c=a.__d),c)return a.__E=a}catch(d){t=d}throw t}},Ee=0,R.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=x({},this.state),typeof t=="function"&&(t=t(x({},n),this.props)),t&&x(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),ue(this))},R.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),ue(this))},R.prototype.render=Q,A=[],Ne=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ce=function(t,e){return t.__v.__b-e.__v.__b},K.__r=0,xe=/(PointerCapture)$|Capture$/i,re=0,Z=fe(!1),ee=fe(!0);var Ve=0;function l(t,e,n,o,a,r){e||(e={});var c,d,f=e;if("ref"in f)for(d in f={},e)d=="ref"?c=e[d]:f[d]=e[d];var s={type:t,props:f,key:n,ref:c,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Ve,__i:-1,__u:0,__source:a,__self:r};if(typeof t=="function"&&(c=t.defaultProps))for(d in c)f[d]===void 0&&(f[d]=c[d]);return b.vnode&&b.vnode(s),s}var L,E,Y,pe,z=0,De=[],N=b,he=N.__b,me=N.__r,ye=N.diffed,ve=N.__c,ge=N.unmount,be=N.__;function ae(t,e){N.__h&&N.__h(E,t,z||e),z=0;var n=E.__H||(E.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function w(t){return z=1,Ke(Fe,t)}function Ke(t,e,n){var o=ae(L++,2);if(o.t=t,!o.__c&&(o.__=[Fe(void 0,e),function(d){var f=o.__N?o.__N[0]:o.__[0],s=o.t(f,d);f!==s&&(o.__N=[s,o.__[1]],o.__c.setState({}))}],o.__c=E,!E.__f)){var a=function(d,f,s){if(!o.__c.__H)return!0;var p=o.__c.__H.__.filter(function(u){return!!u.__c});if(p.every(function(u){return!u.__N}))return!r||r.call(this,d,f,s);var i=o.__c.props!==d;return p.forEach(function(u){if(u.__N){var _=u.__[0];u.__=u.__N,u.__N=void 0,_!==u.__[0]&&(i=!0)}}),r&&r.call(this,d,f,s)||i};E.__f=!0;var r=E.shouldComponentUpdate,c=E.componentWillUpdate;E.componentWillUpdate=function(d,f,s){if(this.__e){var p=r;r=void 0,a(d,f,s),r=p}c&&c.call(this,d,f,s)},E.shouldComponentUpdate=a}return o.__N||o.__}function F(t,e){var n=ae(L++,3);!N.__s&&Le(n.__H,e)&&(n.__=t,n.u=e,E.__H.__h.push(n))}function ze(t,e){var n=ae(L++,7);return Le(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function Ge(t,e){return z=8,ze(function(){return t},e)}function Je(){for(var t;t=De.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(V),t.__H.__h.forEach(ne),t.__H.__h=[]}catch(e){t.__H.__h=[],N.__e(e,t.__v)}}N.__b=function(t){E=null,he&&he(t)},N.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),be&&be(t,e)},N.__r=function(t){me&&me(t),L=0;var e=(E=t.__c).__H;e&&(Y===E?(e.__h=[],E.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.forEach(V),e.__h.forEach(ne),e.__h=[],L=0)),Y=E},N.diffed=function(t){ye&&ye(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(De.push(e)!==1&&pe===N.requestAnimationFrame||((pe=N.requestAnimationFrame)||Qe)(Je)),e.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Y=E=null},N.__c=function(t,e){e.some(function(n){try{n.__h.forEach(V),n.__h=n.__h.filter(function(o){return!o.__||ne(o)})}catch(o){e.some(function(a){a.__h&&(a.__h=[])}),e=[],N.__e(o,n.__v)}}),ve&&ve(t,e)},N.unmount=function(t){ge&&ge(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{V(o)}catch(a){e=a}}),n.__H=void 0,e&&N.__e(e,n.__v))};var ke=typeof requestAnimationFrame=="function";function Qe(t){var e,n=function(){clearTimeout(o),ke&&cancelAnimationFrame(e),setTimeout(t)},o=setTimeout(n,35);ke&&(e=requestAnimationFrame(n))}function V(t){var e=E,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),E=e}function ne(t){var e=E;t.__c=t.__(),E=e}function Le(t,e){return!t||t.length!==e.length||e.some(function(n,o){return n!==t[o]})}function Fe(t,e){return typeof e=="function"?e(t):e}const I=({children:t,className:e="",style:n={},title:o=""})=>{const[a,r]=w(window.location.pathname||"/");F(()=>{const s=()=>r(window.location.pathname||"/");return window.addEventListener("popstate",s),()=>window.removeEventListener("popstate",s)},[]);const c=[{href:"/home",label:"Home"},{href:"/alarms",label:"Alarm"},{href:"/nap",label:"Nap"},{href:"/settings",label:"Settings"}];function d(s){return s==="/home"&&(a==="/"||a==="/home")||a===s?!0:a.startsWith(s+"/")}function f(s){const i=s.currentTarget.getAttribute("href");!i||!i.startsWith("/")||(s.preventDefault(),i!==window.location.pathname&&(history.pushState(null,"",i),window.dispatchEvent(new PopStateEvent("popstate")),r(i)))}return l("div",{className:`page ${e}`,style:n,children:[l("header",{className:"page-header",children:[o?l("h1",{className:"page-title",children:o}):null,l("nav",{className:"nav-bar","aria-label":"Primary",children:c.map(s=>l("a",{className:`nav-link ${d(s.href)?"active":""}`,href:s.href,onClick:f,children:s.label},s.href))})]}),l("main",{className:"page-content",children:t})]})},v=({children:t,justify:e="center",direction:n="row",className:o="",onClick:a})=>{const c={display:"flex",justifyContent:e==="left"?"flex-start":e==="right"?"flex-end":"center",flexDirection:n};return l("div",{className:`box ${o}`,style:c,onClick:a,children:t})},Xe=({navigate:t})=>l(I,{title:"E-Ink Clock",children:l(v,{children:l("p",{children:"Configure your e-ink Clock"})})}),se=({text:t="",onClick:e=()=>{},className:n="",disabled:o=!1,type:a="button"})=>l("button",{type:a,className:`button ${n}`,onClick:e,disabled:o,children:t}),Ye=({headers:t=[],children:e})=>l("table",{className:"list-table",role:"table",children:[t&&t.length>0?l("thead",{children:l("tr",{children:t.map((n,o)=>l("th",{className:"list-header-cell",children:n},o))})}):null,l("tbody",{children:e})]}),Ie=()=>{const[t,e]=w(1);return F(()=>{const n=setInterval(()=>e(o=>o%4+1),800);return()=>clearInterval(n)},[]),l("div",{className:"loading",children:`Loading ${".".repeat(t)}`})},Ze=({alarm:t,navigate:e})=>{const n=()=>{e(`/alarms/${t.id}`)};return l("tr",{className:"list-row",children:[l("td",{className:"list-cell",children:t.name}),l("td",{className:"list-cell",children:t.time}),l("td",{className:"list-cell",children:[t.days[0]&&"M  ",t.days[1]&&"Tu  ",t.days[2]&&"W  ",t.days[3]&&"Th  ",t.days[4]&&"F  ",t.days[5]&&"Sa  ",t.days[6]&&"Su"]}),l("td",{className:"list-cell",children:t.enabled?"✔":"✖"}),l("td",{className:"list-cell",children:l(se,{text:"Edit",onClick:()=>n()})})]})},et=({navigate:t})=>{const[e,n]=w(!0),[o,a]=w([]),[r,c]=w(""),[d,f]=w("");F(()=>{n(!0),(async()=>{let u=0;for(;u<3;)try{const m=await(await fetch("/api/alarms")).json();a(m),n(!1);return}catch(_){u++,console.error(_ instanceof Error?_.message:String(_)),u<3&&await new Promise(m=>setTimeout(m,2e3))}c("Failed to retrieve alarms after multiple attempts"),n(!1)})()},[]);const s=async()=>{f("");let i=0;for(;i<3;)try{const _=await(await fetch("/api/alarms/create",{method:"POST",headers:{"Content-Type":"application/json"}})).json();if(_.success&&_.alarm_id){t(`/alarms/${_.alarm_id}`);return}console.error("Create failed:",_.error),i++,i<3&&await new Promise(m=>setTimeout(m,2e3))}catch(u){console.error(u instanceof Error?u.message:String(u)),i++,i<3&&await new Promise(_=>setTimeout(_,2e3))}f("Failed to create alarm after multiple attempts")},p=["Alarm","Time","Days","Enabled","Actions"];return l(I,{title:"E-Ink Clock",children:r?l(v,{children:l("p",{className:"error",children:r})}):e?l(v,{children:l(Ie,{})}):l("div",{children:[l(v,{children:o.length>0?l(Ye,{headers:p,children:o.map(i=>l(Ze,{alarm:i,navigate:t}))}):l("p",{children:"No alarms configured"})}),l(v,{direction:"column",children:[l(v,{direction:"row",justify:"right",children:l(se,{text:"Add Alarm",onClick:s})}),l(v,{direction:"row",justify:"right",children:d&&l("span",{className:"error-msg",style:"margin-top: 8px",children:d})})]})]})})},tt=({navigate:t})=>l(I,{title:"E-Ink Clock",children:[l(v,{justify:"left",children:l("span",{className:"page-subtitle",children:"Nap Details:"})}),l(v,{children:"coming soon"})]}),nt=({navigate:t})=>l(I,{title:"E-Ink Clock",children:l("p",{children:"Settings"})}),we=({value:t,onSave:e,param:n,valid:o})=>{const[a,r]=w(!1),[c,d]=w(t),[f,s]=w(""),p=()=>{d(t),r(!0),s("")},i=()=>{r(!1),d(t),s("")},u=g=>o&&!o.includes(g.trim())?`Valid values: ${o.join(", ")}`:"",_=g=>{const h=g.target.value;d(h),s(u(h))},m=async()=>{const g=u(c);if(g){s(g);return}try{const h=await e(n,c.trim());h===""?(r(!1),s("")):s(h)}catch{s("Error")}};return a?l(v,{className:"editable-input",direction:"column",children:[l(v,{direction:"row",children:[l("input",{type:"text",value:c,onInput:_,onKeyDown:g=>{g.key==="Enter"&&m(),g.key==="Escape"&&i()}}),l("button",{type:"button",onClick:m,disabled:!!f,style:"margin-left:8px",children:"✔"}),l("button",{type:"button",onClick:i,style:"margin-left:8px",children:"✖"})]}),f&&l("span",{className:"error-msg",children:f})]}):l(v,{justify:"left",className:"editable-input",onClick:p,children:c})},O=({value:t,onSave:e,param:n,min:o,max:a})=>{const[r,c]=w(!1),[d,f]=w(t),[s,p]=w(""),i=()=>{f(t),c(!0),p("")},u=()=>{c(!1),f(t),p("")},_=h=>o!==void 0&&h<o?`Value must be ≥ ${o}`:a!==void 0&&h>a?`Value must be ≤ ${a}`:"",m=h=>{const y=Number(h.target.value);f(y),p(_(y))},g=async()=>{const h=_(d);if(h!==""){p(h);return}const y=await e(n,d);y===""?(c(!1),p("")):p(y)};return r?l(v,{className:"editable-input",direction:"column",children:[l(v,{direction:"row",children:[l("input",{type:"number",value:d,onInput:m,onKeyDown:h=>{h.key==="Enter"&&g(),h.key==="Escape"&&u()}}),l("button",{type:"button",onClick:g,disabled:!!s,style:"margin-left:8px",children:"✔"}),l("button",{type:"button",onClick:u,style:"margin-left:8px",children:"✖"})]}),s&&l("span",{className:"error-msg",children:s})]}):l(v,{justify:"left",className:"editable-input",onClick:i,children:t})},rt=({value:t,onSave:e,param:n})=>{const[o,a]=w(!1),[r,c]=w(t),[d,f]=w(""),s=()=>{c(t),a(!0),f("")},p=()=>{a(!1),f(""),c(t)},i=async()=>{const u=await e(n,r);u===""?(a(!1),f("")):f(u)};return o?l(v,{className:"editable-input",children:[l("div",{children:l("div",{children:[l("span",{children:"M:"}),l("input",{type:"checkbox",checked:r[0],onChange:u=>{const _=r;_[0]=u.target.checked,c(_)}}),l("span",{children:"Tu:"}),l("input",{type:"checkbox",checked:r[1],onChange:u=>{const _=r;_[1]=u.target.checked,c(_)}}),l("span",{children:"W:"}),l("input",{type:"checkbox",checked:r[2],onChange:u=>{const _=r;_[2]=u.target.checked,c(_)}}),l("span",{children:"Th:"}),l("input",{type:"checkbox",checked:r[3],onChange:u=>{const _=r;_[3]=u.target.checked,c(_)}}),l("span",{children:"F:"}),l("input",{type:"checkbox",checked:r[4],onChange:u=>{const _=r;_[4]=u.target.checked,c(_)}}),l("span",{children:"Sa:"}),l("input",{type:"checkbox",checked:r[5],onChange:u=>{const _=r;_[5]=u.target.checked,c(_)}}),l("span",{children:"Su:"}),l("input",{type:"checkbox",checked:r[6],onChange:u=>{const _=r;_[6]=u.target.checked,c(_)}}),l("button",{type:"button",onClick:i,style:"margin-left:8px",children:"✔"}),l("button",{type:"button",onClick:p,style:"margin-left:8px",children:"✖"})]})}),l(v,{children:d&&l("span",{className:"error-msg",children:d})})]}):l(v,{justify:"left",className:"editable-input",onClick:s,children:[r[0]&&"M  ",r[1]&&"Tu  ",r[2]&&"W  ",r[3]&&"Th  ",r[4]&&"F  ",r[5]&&"Sa  ",r[6]&&"Su"]})},B=({value:t,onSave:e,param:n})=>{const[o,a]=w(!1),[r,c]=w(t),[d,f]=w(""),s=()=>{c(t),a(!0),f("")},p=()=>{a(!1),f(""),c(t)},i=async()=>{const u=await e(n,r);u===""?(a(!1),f("")):f(u)};return o?l(v,{className:"editable-input",direction:"column",children:[l(v,{direction:"row",children:[l("input",{type:"checkbox",checked:r,onInput:u=>c(u.target.checked),onKeyDown:u=>{u.key==="Enter"&&i(),u.key==="Escape"&&p()}}),l("button",{type:"button",onClick:i,style:"margin-left:8px",children:"✔"}),l("button",{type:"button",onClick:p,style:"margin-left:8px",children:"✖"})]}),d&&l("span",{className:"error-msg",children:d})]}):l(v,{justify:"left",className:"editable-input",onClick:s,children:r?"✔":"✖"})},ot=({navigate:t})=>{const[e,n]=w(),[o,a]=w(!0),[r,c]=w(""),[d,f]=w("");F(()=>{a(!0),(async()=>{try{const _=window.location.pathname.split("/")[2],g=await(await fetch(`/api/alarms/${_}`)).json();n(g),a(!1)}catch(u){c("Failed to retrieve alarm details"),console.error(u instanceof Error?u.message:String(u))}})()},[]);const s=async()=>{if(!e||!confirm("Are you sure you want to delete this alarm?"))return;let i=0;for(;i<3;)try{const _=await(await fetch(`/api/alarms/${e.id}/delete`,{method:"POST",headers:{"Content-Type":"application/json"}})).json();if(_.success){t("/alarms");return}else{console.error("Delete failed:",_.error),i++,i<3&&await new Promise(m=>setTimeout(m,2e3));continue}}catch(u){console.error(u instanceof Error?u.message:String(u)),i++,i<3&&await new Promise(_=>setTimeout(_,2e3))}f("Failed to delete alarm after multiple attempts")},p=async(i,u)=>{const _={param:i,value:u};let m=0;for(;m<3;)try{const h=await(await fetch(`/api/alarms/${e?.id}/update`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)})).json();if(h.success)return n(y=>y&&{...y,[i]:u}),"";if(h.error==="failed"){console.log("updateAlarm attempt failed. Param:",i,"Value:",u),m++,m<3&&await new Promise(y=>setTimeout(y,2e3));continue}return console.error("updateAlarm error:",h.error),"Alarm edit failed"}catch{m++,m<3&&await new Promise(g=>setTimeout(g,2e3))}return"Alarm edit failed after multiple attempts"};return l(I,{title:"E-Ink Clock",children:r?l(v,{children:l("p",{className:"error",children:r})}):o?l(v,{children:l(Ie,{})}):l("div",{children:[l(v,{justify:"left",children:l("span",{className:"page-subtitle",children:"Alarm Details:"})}),l(v,{justify:"left",children:[l("span",{children:"Name: "}),e&&l(we,{value:e.name,param:"name",onSave:p})]}),l(v,{justify:"left",children:[l("span",{children:"Hour: "}),e&&l(O,{value:e.hour,min:1,max:12,param:"hour",onSave:p})]}),l(v,{justify:"left",children:[l("span",{children:"Minute: "}),e&&l(O,{value:e.minute,param:"minute",min:1,max:59,onSave:p})]}),l(v,{justify:"left",children:[l("span",{children:"AM/PM: "}),e&&l(we,{value:e.am_pm,param:"am_pm",valid:["AM","PM"],onSave:p})]}),l(v,{justify:"left",children:[l("span",{children:"Days: "}),e&&l(rt,{value:e.days,param:"days",onSave:p})]}),l(v,{justify:"left",children:[l("span",{children:"Enabled: "}),e&&l(B,{value:e.enabled,param:"enabled",onSave:p})]}),l(v,{justify:"left",children:[l("span",{children:"Tone: "}),e&&l(B,{value:e.tone,param:"tone",onSave:p})]}),l(v,{justify:"left",children:[l("span",{children:"Tone Frequency: "}),e&&l(O,{value:e.frequency,param:"frequency",min:200,max:1e4,onSave:p})]}),l(v,{justify:"left",children:[l("span",{children:"Audio: "}),e&&l(B,{value:e.audio,param:"audio",onSave:p})]}),l(v,{justify:"left",children:[l("span",{children:"Ramp: "}),e&&l(B,{value:e.ramp,param:"ramp",onSave:p})]}),l(v,{justify:"left",children:[l("span",{children:"Volume: "}),e&&l(O,{value:e.volume,min:0,max:100,param:"volume",onSave:p})]}),l(v,{direction:"column",justify:"center",children:[l(se,{text:"Delete Alarm",onClick:s}),d&&l("span",{className:"error-msg",children:d})]})]})})};function it(){const[t,e]=w(window.location.pathname||"/"),n=Ge(o=>{o!==window.location.pathname&&(history.pushState(null,"",o),e(o))},[]);return F(()=>{const o=()=>e(window.location.pathname);return window.addEventListener("popstate",o),()=>window.removeEventListener("popstate",o)},[]),{path:t,navigate:n}}const lt=()=>{const{path:t,navigate:e}=it();return t==="/alarms"?l(et,{navigate:e}):t.startsWith("/alarms/")?l(ot,{navigate:e}):t==="/nap"?l(tt,{navigate:e}):t==="/settings"?l(nt,{navigate:e}):l(Xe,{navigate:e})},at=document.getElementById("root");Re(l(lt,{}),at);
